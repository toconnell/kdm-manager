<!-- collections -->
<div
    class="ng_fade dashboard_menu"
    ng-init='setUserCollection({{current_user.collection}})'
>

    <h2
        class="clickable dashboard_rollup collection collection_gradient"
        ng-click="rollUp('collectionDiv');"
        ng-class="{'open': ngRolledUp['collectionDiv'] === false}"
    >

        <span class="roll_icon_holder kdm_font_hit_locations dashboard_kdm_font">
            a
        </span>

        </span>

        <span class="roll_content_title">
            KD Collection
        </span>

        <span
            class="roll_content_arrow"
            ng-class="{'open': ngRolledUp['collectionDiv'] === false}"
        >
            &#x25BC;
        </span>

    </h2>

    <div
        id="collectionDiv"
        class="
            roll_down_container
            dashboard_accordion
            dashboard_user_collection_container
            collection_gradient
            rolled_up
        "
        ng-class="{'rolled_down': ngRolledUp['collectionDiv'] === false}"
    >

        <span
            class="hidden"
            ng-if="ngRolledUp['collectionDiv'] === false"
        >
        </span>

        <p class="panel_top_tooltip">
            Use the checkboxes below to record which <i>Monster</i>
            expansions are in your personal KD collection!
        </p>

        <p class="panel_top_tooltip">
            You can then use your Collection to add Fighting Arts, Disorders
            and Settlement Events from your expansions to your campaigns
            without adding monsters, gear, locations, etc.
        </p>

        <div
            class="dashboard_user_collection_repeater"
            ng-repeat="category in [
                'Quarry',
                'Nemesis',
                'White Box',
                'Enhancement'
            ]"
        >
            <h3 class="kd title">{a category a}</h3>

            <center
                ng-if="!kingdomDeath.expansions"
            >
                <img class="tiny_loader" src="/static/media/loading_io.gif"/>
            </center>

            <div
                class="clickable"
                ng-repeat="(handle, expansion) in kingdomDeath.expansions"
            >
                <div
                    class="kd worksheet_row"
                    ng-click="toggleUserExpansion(handle)"
                    ng-if="expansion.ui.pretty_category === category"
                >

                    <div
                        class="kd checkbox"
                        ng-class="{'checked': scratch.userCollection.expansions.indexOf(handle) != -1}"
                    ></div>

                    <div
                        class="kd checkbox_desc"
                        ng-class="{'checked': scratch.userCollection.expansions.indexOf(handle) != -1}"
                        >
                        {a expansion.name a}
                    </div>

                </div>

                <div
                    class="kd worksheet_row caption"
                    ng-if="
                        expansion.ui.pretty_category === category &&
                        expansion.subtitle !== undefined
                    "
                    ng-bind-html="expansion.subtitle|trustedHTML"
                >
                </div>

            </div><!-- expansion repeater / clickable-->

        </div><!-- category repeater -->

    </div><!-- collection div/accordion -->

</div><!-- dashboard_menu -->
